{"ast":null,"code":"import _slicedToArray from\"E:/projects/Fun/genetic algorithm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"E:/projects/Fun/genetic algorithm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"E:/projects/Fun/genetic algorithm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React,{createRef,useEffect,useState,useRef}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";var GlobalStateContext=/*#__PURE__*/React.createContext(undefined);var GlobalActionsContext=/*#__PURE__*/React.createContext(undefined);var bounds={w:window.innerWidth-20,h:window.innerHeight-20,l:10,t:10};// bounds = {\n//   l: screenRef.current.offsetLeft,\n//   t: screenRef.current.offsetTop,\n//   w: screenRef.current.clientWidth,\n//   h: screenRef.current.clientHeight,\n// };\nvar useInterval=function useInterval(callback,delay){var savedCallback=useRef();// Remember the latest callback.\nuseEffect(function(){savedCallback.current=callback;});// Set up the interval.\nuseEffect(function(){function tick(){if(typeof(savedCallback===null||savedCallback===void 0?void 0:savedCallback.current)!==\"undefined\"){savedCallback===null||savedCallback===void 0?void 0:savedCallback.current();}}if(delay!==null){var id=setInterval(tick,delay);return function(){return clearInterval(id);};}},[delay]);};var groundInitial=Array(100).fill(Array(100).fill({}));groundInitial.forEach(function(row,i){row.forEach(function(cell,j){groundInitial[i][j]=/*#__PURE__*/createRef();var initialCreature={row:i,col:j,birth:Date.now(),color:\"#2BFF00\"};groundInitial[i][j].current=Math.random()>0.7?initialCreature:null;});groundInitial[i]=_toConsumableArray(row);});var ga=/*#__PURE__*/_regeneratorRuntime.mark(function ga(){var gen;return _regeneratorRuntime.wrap(function ga$(_context){while(1){switch(_context.prev=_context.next){case 0:gen=0;case 1:if(!(gen<100)){_context.next=8;break;}groundInitial.forEach(function(row,i){row.forEach(function(cell,j){if(groundInitial[i][j].current){var sign=[-1,1];var signX=Math.floor(Math.random()*2);var signY=Math.floor(Math.random()*2);var distX=Math.floor(Math.random()*2);var distY=Math.floor(Math.random()*2);var rowNew=groundInitial[i][j].current.row+sign[signX]*distX;var colNew=groundInitial[i][j].current.col+sign[signY]*distY;if(rowNew<0)rowNew=0;if(rowNew>=100)rowNew=99;if(colNew<0)colNew=0;if(colNew>=100)colNew=99;groundInitial[rowNew][colNew].current=groundInitial[i][j].current;groundInitial[rowNew][colNew].current.row=rowNew;groundInitial[rowNew][colNew].current.col=colNew;groundInitial[i][j].current=null;}});groundInitial[i]=_toConsumableArray(row);});_context.next=5;return{ground:groundInitial};case 5:gen++;_context.next=1;break;case 8:case\"end\":return _context.stop();}}},ga);});var GlobalContextProvider=function GlobalContextProvider(_ref){var children=_ref.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),ground=_useState2[0],setGround=_useState2[1];var gaProcessSteps=ga();useEffect(function(){console.log(gaProcessSteps);},gaProcessSteps);useInterval(function(){// console.log(gaProcessSteps)\nif(!gaProcessSteps)return;var next=gaProcessSteps.next();// console.log(next);\nif(next.done)return;var groundState=next.value;setGround(_toConsumableArray(groundState.ground));},2000);return/*#__PURE__*/_jsx(GlobalStateContext.Provider,{value:{ground:ground},children:/*#__PURE__*/_jsx(GlobalActionsContext.Provider,{value:{setGround:setGround},children:children})});};var useGlobalState=function useGlobalState(){var context=React.useContext(GlobalStateContext);if(context===undefined){throw new Error(\"useGlobalState error\");}return context;};var useGlobalActions=function useGlobalActions(){var context=React.useContext(GlobalActionsContext);if(context===undefined){throw new Error(\"useGlobalActions error\");}return context;};export{useGlobalState,useGlobalActions,GlobalContextProvider};","map":{"version":3,"sources":["E:/projects/Fun/genetic algorithm/src/context/globalContext.js"],"names":["React","createRef","useEffect","useState","useRef","GlobalStateContext","createContext","undefined","GlobalActionsContext","bounds","w","window","innerWidth","h","innerHeight","l","t","useInterval","callback","delay","savedCallback","current","tick","id","setInterval","clearInterval","groundInitial","Array","fill","forEach","row","i","cell","j","initialCreature","col","birth","Date","now","color","Math","random","ga","gen","sign","signX","floor","signY","distX","distY","rowNew","colNew","ground","GlobalContextProvider","children","setGround","gaProcessSteps","console","log","next","done","groundState","value","useGlobalState","context","useContext","Error","useGlobalActions"],"mappings":"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","sourcesContent":["import React, { createRef, useEffect, useState ,useRef} from \"react\";\r\n\r\n\r\n\r\nconst GlobalStateContext = React.createContext(undefined);\r\nconst GlobalActionsContext = React.createContext(undefined);\r\n\r\n\r\nconst bounds = {w:window.innerWidth-20,h:window.innerHeight-20,l:10,t:10}\r\n// bounds = {\r\n//   l: screenRef.current.offsetLeft,\r\n//   t: screenRef.current.offsetTop,\r\n//   w: screenRef.current.clientWidth,\r\n//   h: screenRef.current.clientHeight,\r\n// };\r\n\r\nconst useInterval = (callback, delay) => {\r\n  const savedCallback = useRef();\r\n\r\n  // Remember the latest callback.\r\n  useEffect(() => {\r\n    savedCallback.current = callback;\r\n  });\r\n  // Set up the interval.\r\n  useEffect(() => {\r\n    function tick() {\r\n      if (typeof savedCallback?.current !== \"undefined\") {\r\n        savedCallback?.current();\r\n      }\r\n    }\r\n    if (delay !== null) {\r\n      const id = setInterval(tick, delay);\r\n      return () => clearInterval(id);\r\n    }\r\n  }, [delay]);\r\n};\r\n\r\n\r\n\r\nconst groundInitial = Array(100).fill(Array(100).fill({}));\r\ngroundInitial.forEach((row, i) => {\r\n  row.forEach((cell, j) => {\r\n    groundInitial[i][j] = createRef();\r\n\r\n    const initialCreature = {\r\n      row: i,\r\n      col: j,\r\n      birth: Date.now(),\r\n      color: \"#2BFF00\",\r\n    };\r\n    groundInitial[i][j].current = Math.random() > 0.7 ? initialCreature : null;\r\n  });\r\n\r\n  groundInitial[i] = [...row];\r\n});\r\n\r\nconst ga = function*(){\r\n\r\n  for(var gen=0;gen<100;gen++){\r\n    groundInitial.forEach((row, i) => {\r\n      row.forEach((cell, j) => {\r\n        if (groundInitial[i][j].current) {\r\n          const sign = [-1, 1];\r\n          const signX = Math.floor(Math.random() * 2);\r\n          const signY = Math.floor(Math.random() * 2);\r\n          const distX = Math.floor(Math.random() * 2);\r\n          const distY = Math.floor(Math.random() * 2);\r\n\r\n          var rowNew = groundInitial[i][j].current.row + sign[signX] * distX;\r\n          var colNew = groundInitial[i][j].current.col + sign[signY] * distY;\r\n\r\n          if (rowNew < 0) rowNew = 0;\r\n          if (rowNew >= 100) rowNew = 99;\r\n          if (colNew < 0) colNew = 0;\r\n          if (colNew >= 100) colNew = 99;\r\n\r\n          groundInitial[rowNew][colNew].current = groundInitial[i][j].current;\r\n          groundInitial[rowNew][colNew].current.row = rowNew;\r\n          groundInitial[rowNew][colNew].current.col = colNew;\r\n          groundInitial[i][j].current = null;\r\n        }\r\n      });\r\n       groundInitial[i] = [...row];\r\n    });\r\n    yield{ground:groundInitial}\r\n\r\n  }\r\n  \r\n  \r\n\r\n    \r\n    \r\n  \r\n}\r\n\r\nconst GlobalContextProvider = ({ children }) => {\r\n  \r\n\r\n  \r\n  const [ground, setGround] = useState([]);\r\n  const gaProcessSteps = ga();\r\n\r\n  useEffect(()=>{\r\n    console.log(gaProcessSteps)\r\n  },gaProcessSteps)\r\n    \r\n\r\n\r\n  \r\n\r\n\r\n  useInterval(() => {\r\n    // console.log(gaProcessSteps)\r\n    \r\n    if (!gaProcessSteps) return;\r\n    const next = gaProcessSteps.next();\r\n    // console.log(next);\r\n    if (next.done) return ;\r\n    const groundState = next.value;\r\n    \r\n    setGround([...groundState.ground]);\r\n    \r\n  }, 2000);\r\n\r\n  return (\r\n    <GlobalStateContext.Provider\r\n      value={{\r\n        ground\r\n      }}\r\n      \r\n    >\r\n      <GlobalActionsContext.Provider value={{ setGround }}>\r\n        {children}\r\n      </GlobalActionsContext.Provider>\r\n    </GlobalStateContext.Provider>\r\n  );\r\n};\r\n\r\nconst useGlobalState = () => {\r\n  const context = React.useContext(GlobalStateContext);\r\n  if (context === undefined) {\r\n    throw new Error(\r\n      \"useGlobalState error\"\r\n    );\r\n  }\r\n\r\n  return context;\r\n};\r\n\r\nconst useGlobalActions = () => {\r\n  const context = React.useContext(GlobalActionsContext);\r\n  if (context === undefined) {\r\n    throw new Error(\r\n      \"useGlobalActions error\"\r\n    );\r\n  }\r\n\r\n  return context;\r\n};\r\n\r\nexport { useGlobalState, useGlobalActions, GlobalContextProvider };\r\n"]},"metadata":{},"sourceType":"module"}