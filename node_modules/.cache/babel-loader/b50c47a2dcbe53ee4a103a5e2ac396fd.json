{"ast":null,"code":"var _jsxFileName = \"E:\\\\projects\\\\Fun\\\\genetic algorithm\\\\src\\\\components\\\\experiments\\\\screen.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createRef, useEffect, useRef, useState } from \"react\";\nimport { Card } from \"react-bootstrap\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst demo = Array.from(Array(20).keys());\n\nconst Creature = props => {\n  _s();\n\n  const earthDimensions = props.dim; //   console.log(earthDimensions);\n\n  const creatureRef = useRef(null);\n  const size = 10;\n  const [position, setPosition] = useState({\n    x: Math.floor(props.dim.w * Math.random() + props.dim.left - size / 2),\n    y: Math.floor(props.dim.h * Math.random() + props.dim.top - size / 2)\n  });\n\n  function changePosition() {\n    const pos = [1, -1];\n    const skipX = Math.floor(Math.random() * 20);\n    const skipY = Math.floor(Math.random() * 20);\n    const plusMinusX = Math.floor(Math.random() * 2);\n    const plusMinusY = Math.floor(Math.random() * 2);\n    const newPosition = {\n      x: position.x + pos[plusMinusX] * skipX,\n      y: position.y + pos[plusMinusY] * skipY\n    };\n\n    if (newPosition.x + size > props.dim.w + props.dim.left) {\n      newPosition.x = props.dim.w + props.dim.left - size;\n    }\n\n    if (newPosition.y + size > props.dim.h + props.dim.top) {\n      newPosition.y = props.dim.h + props.dim.top - size;\n    }\n\n    if (newPosition.x < props.dim.left) {\n      newPosition.x = props.dim.left;\n    }\n\n    if (newPosition.y < props.dim.top) {\n      newPosition.y = props.dim.top;\n    }\n\n    setPosition(newPosition);\n  }\n\n  function getNeighbourHood() {\n    const neighbours = [];\n\n    if (creatureRef === null || creatureRef === void 0 ? void 0 : creatureRef.current) {\n      var _creatureRef$current, _creatureRef$current$;\n\n      const children = (_creatureRef$current = creatureRef.current) === null || _creatureRef$current === void 0 ? void 0 : (_creatureRef$current$ = _creatureRef$current.parentNode) === null || _creatureRef$current$ === void 0 ? void 0 : _creatureRef$current$.childNodes;\n\n      if (children) {\n        Object.keys(children).forEach(key => {\n          var _children$key;\n\n          if (((_children$key = children[key]) === null || _children$key === void 0 ? void 0 : _children$key.nodeName) === \"DIV\" && Math.abs(children[key].offsetLeft - position.x) < 10 && Math.abs(children[key].offsetTop - position.y) < 10 && children[key].id.localeCompare(props.uid) !== 0) {\n            neighbours.push(children[key]);\n          }\n        });\n      }\n    }\n\n    return {\n      neighbours\n    };\n  }\n\n  useEffect(() => {\n    // console.log(props.uid);\n    const interval = setInterval(() => {\n      changePosition();\n      const {\n        neighbours\n      } = getNeighbourHood(); //   console.log(neighbours);\n\n      if (neighbours.length > 0) {\n        var _props$earthRef, _props$earthRef$curre;\n\n        const event = new CustomEvent(\"birth\", {\n          detail: {\n            mother: props.uid,\n            candidates: neighbours\n          }\n        });\n        (_props$earthRef = props.earthRef) === null || _props$earthRef === void 0 ? void 0 : (_props$earthRef$curre = _props$earthRef.current) === null || _props$earthRef$curre === void 0 ? void 0 : _props$earthRef$curre.dispatchEvent(event);\n      }\n    }, Math.floor(Math.random() * 5000) + 10);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [position]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: creatureRef,\n    id: props.uid,\n    style: {\n      borderRadius: 5,\n      height: 10,\n      width: 10,\n      backgroundColor: props.color,\n      position: \"absolute\",\n      top: position.y,\n      left: position.x,\n      transition: \"all 0.5s ease-in-out\"\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Creature, \"aEvqTYVwux8B4w6DM5Z7xCsXruM=\");\n\n_c = Creature;\n\nconst Earth = () => {\n  _s2();\n\n  const [creatures, setCreatures] = useState([]);\n  const [earthDimensions, setEarthDimensions] = useState(null);\n  const earthRef = /*#__PURE__*/createRef();\n  useEffect(() => {\n    if (earthRef && earthRef.current) {\n      const handler = e => {\n        if (e.detail) {\n          console.log(e.detail);\n        }\n      };\n\n      earthRef.current.addEventListener(\"birth\", handler);\n      console.log(earthRef);\n      return () => {\n        var _earthRef$current;\n\n        return earthRef === null || earthRef === void 0 ? void 0 : (_earthRef$current = earthRef.current) === null || _earthRef$current === void 0 ? void 0 : _earthRef$current.removeEventListener(\"birth\", handler);\n      };\n    }\n  }, [earthRef, earthRef.current]);\n\n  function addNewCreature(props) {\n    const creaturesTemp = creatures;\n    creaturesTemp.push({\n      uid: uuidv4(),\n      color: (props === null || props === void 0 ? void 0 : props.color) ? props.color : \"#000000\"\n    }); // console.log(creaturesTemp);\n\n    setCreatures([...creaturesTemp]);\n  }\n\n  function removeRandom() {\n    const creaturesTemp = creatures;\n    creaturesTemp.splice(Math.floor(Math.random() * creatures.length), 1);\n    setCreatures([...creaturesTemp]);\n  }\n\n  useEffect(() => {\n    console.log({ ...earthRef\n    });\n\n    if (earthRef && earthRef.current && !earthDimensions) {\n      setEarthDimensions({\n        top: earthRef.current.offsetTop,\n        left: earthRef.current.offsetLeft,\n        w: earthRef.current.offsetWidth,\n        h: earthRef.current.offsetHeight\n      });\n\n      for (var i = 0; i < 20; i++) {\n        addNewCreature();\n      }\n    }\n  }, [earthRef]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: earthRef,\n    style: {\n      backgroundColor: \"#2C931D\",\n      height: \"100%\",\n      width: \"100%\"\n    },\n    onMouseDown: e => {\n      // console.log(onClick);\n      e.preventDefault();\n\n      if (e.button === 0) {\n        addNewCreature();\n      } else {\n        removeRandom();\n      }\n    },\n    children: earthRef && earthDimensions ? creatures.map(creature => {\n      return /*#__PURE__*/_jsxDEV(Creature, {\n        color: creature.color,\n        uid: creature.uid,\n        earthRef: earthRef,\n        dim: earthDimensions\n      }, creature.uid, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 15\n      }, this);\n    }) : null\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(Earth, \"+Q/SETqoUKCIDhgvvzoz7utMkbo=\");\n\n_c2 = Earth;\nexport default Earth;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Creature\");\n$RefreshReg$(_c2, \"Earth\");","map":{"version":3,"sources":["E:/projects/Fun/genetic algorithm/src/components/experiments/screen.js"],"names":["createRef","useEffect","useRef","useState","Card","v4","uuidv4","demo","Array","from","keys","Creature","props","earthDimensions","dim","creatureRef","size","position","setPosition","x","Math","floor","w","random","left","y","h","top","changePosition","pos","skipX","skipY","plusMinusX","plusMinusY","newPosition","getNeighbourHood","neighbours","current","children","parentNode","childNodes","Object","forEach","key","nodeName","abs","offsetLeft","offsetTop","id","localeCompare","uid","push","interval","setInterval","length","event","CustomEvent","detail","mother","candidates","earthRef","dispatchEvent","clearInterval","borderRadius","height","width","backgroundColor","color","transition","Earth","creatures","setCreatures","setEarthDimensions","handler","e","console","log","addEventListener","removeEventListener","addNewCreature","creaturesTemp","removeRandom","splice","offsetWidth","offsetHeight","i","preventDefault","button","map","creature"],"mappings":"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","sourcesContent":["import { createRef, useEffect, useRef, useState } from \"react\";\r\nimport { Card } from \"react-bootstrap\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nconst demo = Array.from(Array(20).keys());\r\n\r\nconst Creature = (props) => {\r\n  const earthDimensions = props.dim;\r\n  //   console.log(earthDimensions);\r\n  const creatureRef = useRef(null);\r\n  const size = 10;\r\n  const [position, setPosition] = useState({\r\n    x: Math.floor(props.dim.w * Math.random() + props.dim.left - size / 2),\r\n    y: Math.floor(props.dim.h * Math.random() + props.dim.top - size / 2),\r\n  });\r\n\r\n  function changePosition() {\r\n    const pos = [1, -1];\r\n    const skipX = Math.floor(Math.random() * 20);\r\n    const skipY = Math.floor(Math.random() * 20);\r\n\r\n    const plusMinusX = Math.floor(Math.random() * 2);\r\n    const plusMinusY = Math.floor(Math.random() * 2);\r\n\r\n    const newPosition = {\r\n      x: position.x + pos[plusMinusX] * skipX,\r\n      y: position.y + pos[plusMinusY] * skipY,\r\n    };\r\n\r\n    if (newPosition.x + size > props.dim.w + props.dim.left) {\r\n      newPosition.x = props.dim.w + props.dim.left - size;\r\n    }\r\n    if (newPosition.y + size > props.dim.h + props.dim.top) {\r\n      newPosition.y = props.dim.h + props.dim.top - size;\r\n    }\r\n    if (newPosition.x < props.dim.left) {\r\n      newPosition.x = props.dim.left;\r\n    }\r\n    if (newPosition.y < props.dim.top) {\r\n      newPosition.y = props.dim.top;\r\n    }\r\n\r\n    setPosition(newPosition);\r\n  }\r\n\r\n  function getNeighbourHood() {\r\n    const neighbours = [];\r\n    if (creatureRef?.current) {\r\n      const children = creatureRef.current?.parentNode?.childNodes;\r\n      if (children) {\r\n        Object.keys(children).forEach((key) => {\r\n          if (\r\n            children[key]?.nodeName === \"DIV\" &&\r\n            Math.abs(children[key].offsetLeft - position.x) < 10 &&\r\n            Math.abs(children[key].offsetTop - position.y) < 10 &&\r\n            children[key].id.localeCompare(props.uid) !== 0\r\n          ) {\r\n            neighbours.push(children[key]);\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    return { neighbours };\r\n  }\r\n\r\n  useEffect(() => {\r\n    // console.log(props.uid);\r\n    const interval = setInterval(() => {\r\n      changePosition();\r\n      const { neighbours } = getNeighbourHood();\r\n      //   console.log(neighbours);\r\n\r\n      if (neighbours.length > 0) {\r\n        const event = new CustomEvent(\"birth\", {\r\n          detail: { mother: props.uid, candidates: neighbours },\r\n        });\r\n        props.earthRef?.current?.dispatchEvent(event);\r\n      }\r\n    }, Math.floor(Math.random() * 5000) + 10);\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, [position]);\r\n  return (\r\n    <div\r\n      ref={creatureRef}\r\n      id={props.uid}\r\n      style={{\r\n        borderRadius: 5,\r\n        height: 10,\r\n        width: 10,\r\n        backgroundColor: props.color,\r\n        position: \"absolute\",\r\n        top: position.y,\r\n        left: position.x,\r\n        transition: \"all 0.5s ease-in-out\",\r\n      }}\r\n    ></div>\r\n  );\r\n};\r\n\r\nconst Earth = () => {\r\n  const [creatures, setCreatures] = useState([]);\r\n  const [earthDimensions, setEarthDimensions] = useState(null);\r\n  const earthRef = createRef();\r\n\r\n  useEffect(() => {\r\n    if (earthRef && earthRef.current) {\r\n      const handler = (e) => {\r\n        if (e.detail) {\r\n          console.log(e.detail);\r\n        }\r\n      };\r\n      earthRef.current.addEventListener(\"birth\", handler);\r\n      console.log(earthRef);\r\n      return () => earthRef?.current?.removeEventListener(\"birth\", handler);\r\n    }\r\n  }, [earthRef, earthRef.current]);\r\n\r\n  function addNewCreature(props) {\r\n    const creaturesTemp = creatures;\r\n    creaturesTemp.push({\r\n      uid: uuidv4(),\r\n      color: props?.color ? props.color : \"#000000\",\r\n    });\r\n    // console.log(creaturesTemp);\r\n    setCreatures([...creaturesTemp]);\r\n  }\r\n\r\n  function removeRandom() {\r\n    const creaturesTemp = creatures;\r\n    creaturesTemp.splice(Math.floor(Math.random() * creatures.length), 1);\r\n    setCreatures([...creaturesTemp]);\r\n  }\r\n  useEffect(() => {\r\n    console.log({ ...earthRef });\r\n    if (earthRef && earthRef.current && !earthDimensions) {\r\n      setEarthDimensions({\r\n        top: earthRef.current.offsetTop,\r\n        left: earthRef.current.offsetLeft,\r\n        w: earthRef.current.offsetWidth,\r\n        h: earthRef.current.offsetHeight,\r\n      });\r\n      for (var i = 0; i < 20; i++) {\r\n        addNewCreature();\r\n      }\r\n    }\r\n  }, [earthRef]);\r\n  return (\r\n    <div\r\n      ref={earthRef}\r\n      style={{ backgroundColor: \"#2C931D\", height: \"100%\", width: \"100%\" }}\r\n      onMouseDown={(e) => {\r\n        // console.log(onClick);\r\n        e.preventDefault();\r\n        if (e.button === 0) {\r\n          addNewCreature();\r\n        } else {\r\n          removeRandom();\r\n        }\r\n      }}\r\n    >\r\n      {earthRef && earthDimensions\r\n        ? creatures.map((creature) => {\r\n            return (\r\n              <Creature\r\n                color={creature.color}\r\n                key={creature.uid}\r\n                uid={creature.uid}\r\n                earthRef={earthRef}\r\n                dim={earthDimensions}\r\n              ></Creature>\r\n            );\r\n          })\r\n        : null}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Earth;\r\n"]},"metadata":{},"sourceType":"module"}